#
# Variation schema for the Bookworms demo application.
#
name: bookworms
description: Variant experiment schema for the Bookworms demo application
flusher:
  class: com.variant.spi.stdlib.flush.TraceEventFlusherCsv

states:
  - name: BookDetails
  - name: Checkout
variations:
  # A/B Test of adding suggestions to the checkout page. Default random targeting,
  # unless user is "WithSuggestions" who is always targeted to the WithSuggestions
  # experience as a matter of demonstrating targeting hook.
  - name: Suggestions
    hooks:
      - class: com.variant.demo.bookworms.spi.UserTargetingHook
    experiences:
      - name: NoSuggestions
        isControl: true
      - name: WithSuggestions
        weight: 999
    onStates:
      - state: Checkout
  # Feature Flag gating access to the reputation feature on the book detail
  # and the checkout pages. ReputationQualificationHook will only allow user
  # "WithReputation" into the feature.
  - name: ReputationFF
    hooks:
      - class: com.variant.demo.bookworms.spi.UserQualificationHook
    # Visitors are re-qualified on each visit to the site.
    durability:
      qualification: session
    experiences:
      - name: WithReputation
        isControl: true
    onStates:
    - state: BookDetails
    - state: Checkout